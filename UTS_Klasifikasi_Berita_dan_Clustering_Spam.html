

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tugas UTS (Klasifikasi Berita dan Clustering Spam) &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'UTS_Klasifikasi_Berita_dan_Clustering_Spam';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analisis Graph Data dari pta_graph.xlsx" href="page_rank.html" />
    <link rel="prev" title="Klasifikasi Berita menggunakan Fitur Latent Dirichlet Allocation" href="tugas6-rifqi.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/profile.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/profile.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="crawling_pta.html">Crawling PTA Trunojoyo</a></li>



<li class="toctree-l1"><a class="reference internal" href="crawling_berita_kompas.html">Crawling Berita Kompas</a></li>






<li class="toctree-l1"><a class="reference internal" href="scrapping_link_informatika.html">Link Scrapping PTA Teknik Informatika</a></li>
<li class="toctree-l1"><a class="reference internal" href="crawling_manajemen.html">Crawling PTA Trunojoyo Fakultas Ekonomi Prodi Manajemen</a></li>



<li class="toctree-l1"><a class="reference internal" href="preprocessing_berita.html">Preprocessing Berita</a></li>

<li class="toctree-l1"><a class="reference internal" href="preprocessing_pta_manajemen.html">Preprocessing PTA Manajemen</a></li>

<li class="toctree-l1"><a class="reference internal" href="ekstraksi_fitur_tfidf_berita.html">Ekstraksi Fitur tf idf Berita</a></li>
<li class="toctree-l1"><a class="reference internal" href="ekstraksi_fitur_tfidf_pta_manajemen.html">Ekstraksi Fitur tf idf Pta Manajemen</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cbow_embeding_berita_preprocesed.html">Cbow Embeding Berita Preprocesed</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cbow_embeding_pta_manajemen_preprocesed.html">Cbow Embeding Pta Manajemen Preprocesed</a></li>
<li class="toctree-l1"><a class="reference internal" href="tugas6-rifqi.html">Klasifikasi Berita menggunakan Fitur Latent Dirichlet Allocation (LDA)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Tugas UTS (Klasifikasi Berita dan Clustering Spam)</a></li>


<li class="toctree-l1"><a class="reference internal" href="page_rank.html">Analisis Graph Data dari pta_graph.xlsx</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FUTS_Klasifikasi_Berita_dan_Clustering_Spam.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/UTS_Klasifikasi_Berita_dan_Clustering_Spam.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tugas UTS (Klasifikasi Berita dan Clustering Spam)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Tugas UTS (Klasifikasi Berita dan Clustering Spam)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-berita-dengan-fitur-topik-lda-naive-bayes-svm">Klasifikasi Berita dengan Fitur Topik (LDA) + Naive Bayes &amp; SVM</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-spam-detection-dengan-k-means">Clustering Spam Detection dengan K-Means</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">Tujuan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologi">Metodologi</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tugas-uts-klasifikasi-berita-dan-clustering-spam">
<h1>Tugas UTS (Klasifikasi Berita dan Clustering Spam)<a class="headerlink" href="#tugas-uts-klasifikasi-berita-dan-clustering-spam" title="Permalink to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="klasifikasi-berita-dengan-fitur-topik-lda-naive-bayes-svm">
<h1>Klasifikasi Berita dengan Fitur Topik (LDA) + Naive Bayes &amp; SVM<a class="headerlink" href="#klasifikasi-berita-dengan-fitur-topik-lda-naive-bayes-svm" title="Permalink to this heading">#</a></h1>
<p>Notebook ini melakukan klasifikasi kategori berita menggunakan ekstraksi fitur berbasis topik (topic modelling) dengan LDA, lalu memanfaatkan vektor distribusi topik sebagai fitur untuk model klasifikasi Naive Bayes dan SVM. Disediakan juga baseline TF‑IDF + LinearSVC untuk perbandingan.</p>
<p>Langkah utama:</p>
<ul class="simple">
<li><p>Memuat dataset <code class="docutils literal notranslate"><span class="pre">Berita.csv</span></code> dan mendeteksi kolom teks/label secara otomatis.</p></li>
<li><p>Praproses teks Bahasa Indonesia: normalisasi, stopword removal, dan stemming (Sastrawi).</p></li>
<li><p>Membangun kamus dan korpus, melatih model LDA, dan mengekstrak distribusi topik dokumen.</p></li>
<li><p>Melatih dan mengevaluasi Multinomial Naive Bayes dan Linear SVM di fitur topik.</p></li>
<li><p>Membuat baseline TF‑IDF + LinearSVC untuk membandingkan performa.</p></li>
</ul>
<p><strong>Instalasi Dependensi</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install required packages (run once)</span>
<span class="c1"># Menginstal pustaka yang dipakai untuk praproses teks, topik modelling, dan klasifikasi</span>
<span class="o">%</span><span class="k">pip</span> install -q pandas numpy scikit-learn gensim Sastrawi nltk matplotlib seaborn tqdm
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<p><strong>Import Library</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import standar dan utilitas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Komputasi numerik dan data frame</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

<span class="c1"># Visualisasi</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Praproses teks (Bahasa Indonesia)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nltk</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Sastrawi.Stemmer.StemmerFactory</span><span class="w"> </span><span class="kn">import</span> <span class="n">StemmerFactory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nltk.corpus</span><span class="w"> </span><span class="kn">import</span> <span class="n">stopwords</span>

<span class="c1"># Topic modelling (LDA)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gensim</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gensim</span><span class="w"> </span><span class="kn">import</span> <span class="n">corpora</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gensim.models.ldamodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">LdaModel</span>

<span class="c1"># Pembelajaran mesin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">accuracy_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Memuat Dataset dan Deteksi Kolom</strong></p>
<p>Kita baca <code class="docutils literal notranslate"><span class="pre">Berita.csv</span></code>, lalu deteksi kolom teks (judul/berita) dan kolom label (kategori) secara heuristik.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Memuat dataset (fallback beberapa encoding umum)</span>
<span class="c1"># Catatan: gunakan try_read_csv agar robust terhadap encoding berbeda</span>
<span class="c1"># df = pd.read_csv(&quot;Berita.csv&quot;)  # opsi cepat jika encoding sudah pasti UTF-8</span>

<span class="c1"># Try to read with common encodings</span>
<span class="k">def</span><span class="w"> </span><span class="nf">try_read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">encodings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="s2">&quot;latin1&quot;</span><span class="p">,</span> <span class="s2">&quot;cp1252&quot;</span><span class="p">,</span> <span class="s2">&quot;iso-8859-1&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="n">encodings</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">enc</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">last_err</span> <span class="o">=</span> <span class="n">e</span>
    <span class="k">raise</span> <span class="n">last_err</span>

<span class="c1"># Sesuaikan path bila perlu</span>
<span class="n">csv_path</span> <span class="o">=</span> <span class="s2">&quot;Berita.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">try_read_csv</span><span class="p">(</span><span class="n">csv_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1500, 6)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>judul</th>
      <th>berita</th>
      <th>tanggal</th>
      <th>kategori</th>
      <th>link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Airlangga Harap Kenaikan UMP Tingkatkan Daya B...</td>
      <td>Menteri Koordinator (Menko) Bidang Perekonomia...</td>
      <td>Minggu, 01 Des 2024 23:40 WIB</td>
      <td>Ekonomi</td>
      <td>https://www.cnnindonesia.com/ekonomi/202412012...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>PT SIER Beri Penghargaan untuk 50 Tenant Terba...</td>
      <td>Dalam rangka memeriahkan hari jadi ke-50, PT S...</td>
      <td>Minggu, 01 Des 2024 20:45 WIB</td>
      <td>Ekonomi</td>
      <td>https://www.cnnindonesia.com/ekonomi/202412012...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Prabowo Bakal Bentuk Kementerian Penerimaan Ne...</td>
      <td>Wacana Presiden Prabowo Subianto akan membentu...</td>
      <td>Minggu, 01 Des 2024 19:40 WIB</td>
      <td>Ekonomi</td>
      <td>https://www.cnnindonesia.com/ekonomi/202412011...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Sinergi Kemenag &amp; BPJS Ketenagakerjaan Lindung...</td>
      <td>BPJS Ketenagakerjaan dan Kementerian Agama (Ke...</td>
      <td>Minggu, 01 Des 2024 19:03 WIB</td>
      <td>Ekonomi</td>
      <td>https://www.cnnindonesia.com/ekonomi/202412011...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Pemerintah Segera Bentuk Satgas PHK Usai Tetap...</td>
      <td>Pemerintah akan segera membentuk Satuan Tugas ...</td>
      <td>Minggu, 01 Des 2024 19:00 WIB</td>
      <td>Ekonomi</td>
      <td>https://www.cnnindonesia.com/ekonomi/202412011...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Deteksi kolom teks/label secara heuristik</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">col_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>

<span class="c1"># Heuristik umum untuk dataset berita</span>
<span class="n">candidate_text_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">c</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;teks&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;berita&quot;</span><span class="p">,</span> <span class="s2">&quot;konten&quot;</span><span class="p">,</span> <span class="s2">&quot;isi&quot;</span><span class="p">,</span> <span class="s2">&quot;judul&quot;</span><span class="p">,</span> <span class="s2">&quot;headline&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">])]</span>
<span class="n">candidate_label_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">c</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;kategori&quot;</span><span class="p">,</span> <span class="s2">&quot;kelas&quot;</span><span class="p">,</span> <span class="s2">&quot;topik&quot;</span><span class="p">,</span> <span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">])]</span>

<span class="n">text_col</span> <span class="o">=</span> <span class="n">col_map</span><span class="p">[</span><span class="n">candidate_text_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">candidate_text_cols</span> <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">label_col</span> <span class="o">=</span> <span class="n">col_map</span><span class="p">[</span><span class="n">candidate_label_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">candidate_label_cols</span> <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detected text column:&quot;</span><span class="p">,</span> <span class="n">text_col</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detected label column:&quot;</span><span class="p">,</span> <span class="n">label_col</span><span class="p">)</span>

<span class="c1"># Bersihkan NA dan standarkan nama kolom</span>
<span class="n">_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">text_col</span><span class="p">,</span> <span class="n">label_col</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">_df</span> <span class="o">=</span> <span class="n">_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">text_col</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">label_col</span><span class="p">:</span> <span class="s2">&quot;label&quot;</span><span class="p">})</span>

<span class="c1"># Lihat distribusi label (cuplikan)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Labels (sample):&quot;</span><span class="p">,</span> <span class="n">_df</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Detected text column: judul
Detected label column: kategori
Labels (sample): label
Ekonomi          375
Olahraga         375
Nasional         375
Internasional    375
Name: count, dtype: int64
(1500, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Airlangga Harap Kenaikan UMP Tingkatkan Daya B...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PT SIER Beri Penghargaan untuk 50 Tenant Terba...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Prabowo Bakal Bentuk Kementerian Penerimaan Ne...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sinergi Kemenag &amp; BPJS Ketenagakerjaan Lindung...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pemerintah Segera Bentuk Satgas PHK Usai Tetap...</td>
      <td>Ekonomi</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Praproses Teks Bahasa Indonesia</strong></p>
<p>Normalisasi huruf kecil, tokenisasi (memecah teks jadi potongan kecil), hapus stopwords (kata penghubung), dan stemming (mengubah kata ke bentuk dasar) Sastrawi untuk menyatukan bentuk kata.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unduh resource NLTK bila belum tersedia</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;indonesian&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
    <span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;indonesian&#39;</span><span class="p">)</span>

<span class="c1"># Kumpulan stopword + tambahan umum di medsos/teks informal</span>
<span class="n">indo_stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;indonesian&#39;</span><span class="p">))</span>
<span class="n">extra_stops</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rt&quot;</span><span class="p">,</span> <span class="s2">&quot;yg&quot;</span><span class="p">,</span> <span class="s2">&quot;dgn&quot;</span><span class="p">,</span> <span class="s2">&quot;nya&quot;</span><span class="p">,</span> <span class="s2">&quot;sih&quot;</span><span class="p">,</span> <span class="s2">&quot;aja&quot;</span><span class="p">,</span> <span class="s2">&quot;dll&quot;</span><span class="p">,</span> <span class="s2">&quot;tuh&quot;</span><span class="p">,</span> <span class="s2">&quot;nih&quot;</span><span class="p">}</span>
<span class="n">indo_stopwords</span> <span class="o">|=</span> <span class="n">extra_stops</span>

<span class="c1"># Inisialisasi stemmer Sastrawi</span>
<span class="n">stemmer</span> <span class="o">=</span> <span class="n">StemmerFactory</span><span class="p">()</span><span class="o">.</span><span class="n">create_stemmer</span><span class="p">()</span>

<span class="c1"># Pola token huruf (inklusif aksen)</span>
<span class="n">TOKEN_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[A-Za-zÀ-ÖØ-öø-ÿ]+&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">normalize_text</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># huruf kecil</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">TOKEN_RE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>  <span class="c1"># tokenisasi sederhana huruf</span>
    <span class="c1"># Hapus stopword &amp; token sangat pendek, lalu lakukan stemming</span>
    <span class="n">processed</span> <span class="o">=</span> <span class="p">[</span><span class="n">stemmer</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span> <span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">tok</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">indo_stopwords</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processed</span><span class="p">)</span>

<span class="c1"># Terapkan normalisasi</span>
<span class="n">_df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">normalize_text</span><span class="p">)</span>

<span class="c1"># Buang baris kosong setelah pembersihan</span>
<span class="n">_df</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="n">_df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">_df</span><span class="p">[[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;clean&#39;</span><span class="p">,</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1500, 3)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>clean</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Airlangga Harap Kenaikan UMP Tingkatkan Daya B...</td>
      <td>airlangga harap naik ump tingkat daya beli mas...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PT SIER Beri Penghargaan untuk 50 Tenant Terba...</td>
      <td>sier harga tenant baik hut</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Prabowo Bakal Bentuk Kementerian Penerimaan Ne...</td>
      <td>prabowo bentuk menteri terima negara pimpin an...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sinergi Kemenag &amp; BPJS Ketenagakerjaan Lindung...</td>
      <td>sinergi kemenag bpjs ketenagakerjaan lindung r...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pemerintah Segera Bentuk Satgas PHK Usai Tetap...</td>
      <td>perintah bentuk satgas phk tetap ump persen</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AHY Buka-bukaan Nasib Kelanjutan Pembangunan I...</td>
      <td>ahy buka buka nasib lanjut bangun ikn era prabowo</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Badan Gizi Soal Biaya Makan Gratis Rp10 Ribu: ...</td>
      <td>badan gizi biaya makan gratis ribu beli bahan ...</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Zulhas Minta Tambahan Anggaran Rp510 M Demi Ca...</td>
      <td>zulhas tambah anggar capai swasembada pangan</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PLN Akan Uji Coba PLTS IKN 22 Desember</td>
      <td>pln uji coba plts ikn desember</td>
      <td>Ekonomi</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Profil Jhony Saputra, Anak Haji Isam yang Jadi...</td>
      <td>profil jhony saputra anak haji isam komisaris ...</td>
      <td>Ekonomi</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Pembangunan Fitur Topik dengan LDA</strong></p>
<p>Melatih LDA, lalu mengambil vektor probabilitas topik per dokumen sebagai fitur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bangun kamus dan korpus untuk LDA</span>
<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>

<span class="c1"># Saring kata yang terlalu jarang/terlalu umum agar topik lebih stabil</span>
<span class="n">dictionary</span> <span class="o">=</span> <span class="n">corpora</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
<span class="n">dictionary</span><span class="o">.</span><span class="n">filter_extremes</span><span class="p">(</span><span class="n">no_below</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">no_above</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Representasi bag-of-words per dokumen</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictionary</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>

<span class="c1"># Latih model LDA (jumlah topik dapat disetel)</span>
<span class="n">num_topics</span> <span class="o">=</span> <span class="mi">20</span>     <span class="c1">#jumlah topik yang akan dipelajari oleh LDA.</span>
<span class="n">passes</span> <span class="o">=</span> <span class="mi">5</span>      <span class="c1">#berapa kali LDA “mengulang” membaca seluruh korpus saat training.</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span>     <span class="c1">#seed acak agar hasil LDA dan pembagian data reproducible (hasil sama tiap dijalankan)</span>

<span class="n">lda</span> <span class="o">=</span> <span class="n">LdaModel</span><span class="p">(</span><span class="n">corpus</span><span class="o">=</span><span class="n">corpus</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="n">num_topics</span><span class="p">,</span> <span class="n">passes</span><span class="o">=</span><span class="n">passes</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

<span class="c1"># Ekstrak distribusi topik per dokumen sebagai vektor berdimensi num_topics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_topic_vector</span><span class="p">(</span><span class="n">bow</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="n">lda</span><span class="o">.</span><span class="n">get_document_topics</span><span class="p">(</span><span class="n">bow</span><span class="p">,</span> <span class="n">minimum_probability</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># selalu kembalikan semua topik</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_topics</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">topic_id</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">topics</span><span class="p">:</span>
        <span class="n">vec</span><span class="p">[</span><span class="n">topic_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
    <span class="k">return</span> <span class="n">vec</span>

<span class="n">X_topics</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">get_topic_vector</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_topics</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1500, 20) 1500
</pre></div>
</div>
</div>
</div>
<p><strong>Eksperimen Variasi Jumlah Topik LDA</strong></p>
<p>Uji beberapa nilai <code class="docutils literal notranslate"><span class="pre">num_topics</span></code> dan ukur akurasi klasifikasi pada fitur distribusi topik LDA. Grafik akan menunjukkan topik berapa yang memberi akurasi tertinggi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sweep beberapa jumlah topik dan evaluasi akurasi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Siapkan texts/labels dari _df yang sudah dibersihkan</span>
<span class="n">texts_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
<span class="n">y_all</span> <span class="o">=</span> <span class="n">_df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Range jumlah topik (ubah sesuai kebutuhan)</span>
<span class="n">topic_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>

<span class="n">results_nb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">results_svm</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">topic_grid</span><span class="p">:</span>
    <span class="c1"># Kamus &amp; korpus ulang agar sesuai filtering tiap k</span>
    <span class="n">dictionary_k</span> <span class="o">=</span> <span class="n">corpora</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">texts_all</span><span class="p">)</span>
    <span class="n">dictionary_k</span><span class="o">.</span><span class="n">filter_extremes</span><span class="p">(</span><span class="n">no_below</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">no_above</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">corpus_k</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictionary_k</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">texts_all</span><span class="p">]</span>

    <span class="c1"># Latih LDA untuk k topik</span>
    <span class="n">lda_k</span> <span class="o">=</span> <span class="n">LdaModel</span><span class="p">(</span><span class="n">corpus</span><span class="o">=</span><span class="n">corpus_k</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">dictionary_k</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">passes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># Dapatkan fitur distribusi topik</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">doc_topic_vec</span><span class="p">(</span><span class="n">bow</span><span class="p">):</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">lda_k</span><span class="o">.</span><span class="n">get_document_topics</span><span class="p">(</span><span class="n">bow</span><span class="p">,</span> <span class="n">minimum_probability</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">vec</span><span class="p">[</span><span class="n">tid</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
        <span class="k">return</span> <span class="n">vec</span>

    <span class="n">X_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">doc_topic_vec</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">corpus_k</span><span class="p">])</span>

    <span class="c1"># Split latih/uji konsisten</span>
    <span class="n">Xtr</span><span class="p">,</span> <span class="n">Xte</span><span class="p">,</span> <span class="n">ytr</span><span class="p">,</span> <span class="n">yte</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_k</span><span class="p">,</span> <span class="n">y_all</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_all</span><span class="p">)</span>

    <span class="c1"># Naive Bayes</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>
    <span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr</span><span class="p">,</span> <span class="n">ytr</span><span class="p">)</span>
    <span class="n">pred_nb</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xte</span><span class="p">)</span>
    <span class="n">acc_nb</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">yte</span><span class="p">,</span> <span class="n">pred_nb</span><span class="p">)</span>
    <span class="n">results_nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc_nb</span><span class="p">)</span>

    <span class="c1"># Linear SVM</span>
    <span class="n">svm</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr</span><span class="p">,</span> <span class="n">ytr</span><span class="p">)</span>
    <span class="n">pred_svm</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xte</span><span class="p">)</span>
    <span class="n">acc_svm</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">yte</span><span class="p">,</span> <span class="n">pred_svm</span><span class="p">)</span>
    <span class="n">results_svm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc_svm</span><span class="p">)</span>

<span class="c1"># Plot hasil</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">topic_grid</span><span class="p">,</span> <span class="n">results_nb</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Naive Bayes (LDA features)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">topic_grid</span><span class="p">,</span> <span class="n">results_svm</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LinearSVC (LDA features)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Topik (num_topics)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Akurasi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Akurasi vs Jumlah Topik (LDA)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">best_nb_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">results_nb</span><span class="p">))</span>
<span class="n">best_svm_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">results_svm</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best NB: topics=</span><span class="si">{</span><span class="n">topic_grid</span><span class="p">[</span><span class="n">best_nb_idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> acc=</span><span class="si">{</span><span class="n">results_nb</span><span class="p">[</span><span class="n">best_nb_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best SVM: topics=</span><span class="si">{</span><span class="n">topic_grid</span><span class="p">[</span><span class="n">best_svm_idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> acc=</span><span class="si">{</span><span class="n">results_svm</span><span class="p">[</span><span class="n">best_svm_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2f272c981ef98411ff836b1a9ca417a127df55a50c93cf4593c2a2977c2badd1.png" src="_images/2f272c981ef98411ff836b1a9ca417a127df55a50c93cf4593c2a2977c2badd1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best NB: topics=50 acc=0.5533
Best SVM: topics=50 acc=0.5533
</pre></div>
</div>
</div>
</div>
<p><strong>Pelatihan dan Evaluasi Model di Fitur Topik</strong></p>
<p>Bagi data menjadi latih/uji, latih MultinomialNB dan LinearSVC, lalu tampilkan metrik akurasi dan classification report.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bagi data latih/uji secara stratified</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_topics</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="c1"># Naive Bayes Multinomial cocok untuk fitur non-negatif (probabilitas topik memenuhi syarat)</span>
<span class="n">nb_clf</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>
<span class="n">nb_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">nb_pred</span> <span class="o">=</span> <span class="n">nb_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Naive Bayes Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">nb_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">nb_pred</span><span class="p">))</span>

<span class="c1"># LinearSVC di fitur probabilitas topik</span>
<span class="n">svm_clf</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">svm_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">svm_pred</span> <span class="o">=</span> <span class="n">svm_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SVM Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">svm_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">svm_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Naive Bayes Accuracy: 0.5133333333333333
               precision    recall  f1-score   support

      Ekonomi       0.47      0.45      0.46        75
Internasional       0.68      0.57      0.62        75
     Nasional       0.36      0.40      0.38        75
     Olahraga       0.58      0.63      0.60        75

     accuracy                           0.51       300
    macro avg       0.52      0.51      0.52       300
 weighted avg       0.52      0.51      0.52       300

SVM Accuracy: 0.52
               precision    recall  f1-score   support

      Ekonomi       0.44      0.45      0.44        75
Internasional       0.70      0.59      0.64        75
     Nasional       0.37      0.37      0.37        75
     Olahraga       0.60      0.67      0.63        75

     accuracy                           0.52       300
    macro avg       0.53      0.52      0.52       300
 weighted avg       0.53      0.52      0.52       300
</pre></div>
</div>
</div>
</div>
<p><strong>Baseline: TF‑IDF + LinearSVC (SVM linear)</strong></p>
<p>Sebagai pembanding, menggunakan fitur TF‑IDF n‑gram dan model LinearSVC untuk klasifikasi teks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Baseline TF-IDF + LinearSVC</span>
<span class="c1"># Menggunakan representasi TF-IDF n-gram (1-2) yang umum kuat untuk klasifikasi teks berita</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TfidfVectorizer</span>

<span class="c1"># Bangun matriks TF-IDF dari teks yang sudah dibersihkan</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">min_df</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">X_tfidf</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">_df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">])</span>

<span class="c1"># Bagi data latih/uji yang konsisten dengan eksperimen LDA</span>
<span class="n">X_train2</span><span class="p">,</span> <span class="n">X_test2</span><span class="p">,</span> <span class="n">y_train2</span><span class="p">,</span> <span class="n">y_test2</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_tfidf</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="c1"># Latih LinearSVC pada fitur TF-IDF</span>
<span class="n">svm_tfidf</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">svm_tfidf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train2</span><span class="p">,</span> <span class="n">y_train2</span><span class="p">)</span>
<span class="n">svm_tfidf_pred</span> <span class="o">=</span> <span class="n">svm_tfidf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test2</span><span class="p">)</span>

<span class="c1"># Tampilkan metrik akurasi dan laporan klasifikasi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TF-IDF LinearSVC Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test2</span><span class="p">,</span> <span class="n">svm_tfidf_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test2</span><span class="p">,</span> <span class="n">svm_tfidf_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TF-IDF LinearSVC Accuracy: 0.8933333333333333
               precision    recall  f1-score   support

      Ekonomi       0.82      0.93      0.88        75
Internasional       0.95      0.95      0.95        75
     Nasional       0.84      0.79      0.81        75
     Olahraga       0.97      0.91      0.94        75

     accuracy                           0.89       300
    macro avg       0.90      0.89      0.89       300
 weighted avg       0.90      0.89      0.89       300
</pre></div>
</div>
</div>
</div>
<p><strong>Ringkasan Hasil</strong></p>
<ul class="simple">
<li><p>Akurasi Naive Bayes dan SVM pada fitur topik LDA moderat (sekitar 0.5 pada contoh output), menandakan representasi topik kurang diskriminatif untuk tugas klasifikasi kategori berita yang spesifik.</p></li>
<li><p>Baseline TF‑IDF + LinearSVC menunjukkan akurasi jauh lebih tinggi (~0.89 pada contoh output), menegaskan bahwa representasi TF‑IDF efektif untuk teks berita.</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="clustering-spam-detection-dengan-k-means">
<h1>Clustering Spam Detection dengan K-Means<a class="headerlink" href="#clustering-spam-detection-dengan-k-means" title="Permalink to this heading">#</a></h1>
<p>Notebook ini melakukan analisis clustering untuk deteksi spam menggunakan algoritma K-Means dengan berbagai teknik preprocessing dan evaluasi.</p>
<section id="tujuan">
<h2>Tujuan<a class="headerlink" href="#tujuan" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Melakukan clustering pada dataset teks untuk mengidentifikasi pola spam</p></li>
<li><p>Mencari jumlah cluster optimal menggunakan silhouette score</p></li>
<li><p>Membandingkan hasil clustering dengan ground truth (jika tersedia)</p></li>
<li><p>Visualisasi hasil clustering dalam 2D menggunakan UMAP</p></li>
</ul>
</section>
<section id="metodologi">
<h2>Metodologi<a class="headerlink" href="#metodologi" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Preprocessing</strong>: Pembersihan teks, normalisasi, dan penghapusan stopwords</p></li>
<li><p><strong>Feature Extraction</strong>: TF-IDF dengan n-gram (1,2) untuk ekstraksi fitur</p></li>
<li><p><strong>Dimensionality Reduction</strong>: SVD (LSA) untuk mengurangi dimensi</p></li>
<li><p><strong>Clustering</strong>: K-Means dengan grid search untuk mencari k optimal</p></li>
<li><p><strong>Evaluasi</strong>: Silhouette score, NMI, dan ARI</p></li>
<li><p><strong>Visualisasi</strong>: UMAP untuk proyeksi 2D</p></li>
</ol>
<p><strong>Setup dan Instalasi Library</strong></p>
<p>Pada bagian ini, kita akan melakukan instalasi otomatis library yang diperlukan dan mengunduh data NLTK yang dibutuhkan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup yang dioptimasi (hanya install jika benar-benar diperlukan)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span><span class="o">,</span><span class="w"> </span><span class="nn">subprocess</span><span class="o">,</span><span class="w"> </span><span class="nn">importlib.util</span>

<span class="c1"># Daftar library yang diperlukan dengan nama package dan module</span>
<span class="n">reqs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;pandas&quot;</span><span class="p">,</span><span class="s2">&quot;pandas&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;numpy&quot;</span><span class="p">,</span><span class="s2">&quot;numpy&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;scikit-learn&quot;</span><span class="p">,</span><span class="s2">&quot;sklearn&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;nltk&quot;</span><span class="p">,</span><span class="s2">&quot;nltk&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">,</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;tqdm&quot;</span><span class="p">,</span><span class="s2">&quot;tqdm&quot;</span><span class="p">)</span>
    <span class="c1"># Hapus umap, seaborn, numba, llvmlite untuk menghindari dependency yang berat</span>
<span class="p">]</span>

<span class="c1"># Cek library mana yang belum terinstall</span>
<span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">m</span> <span class="ow">in</span> <span class="n">reqs</span> <span class="k">if</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_spec</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>

<span class="c1"># Hanya install jika ada yang missing (tidak setiap kali dijalankan)</span>
<span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Installing missing packages: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Install library yang missing dengan prefer binary untuk kecepatan</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">check_call</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="s2">&quot;--prefer-binary&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">missing</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All required packages already installed.&quot;</span><span class="p">)</span>

<span class="c1"># Download stopwords NLTK jika belum ada (lebih cepat)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nltk</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">nltk.corpus</span><span class="w"> </span><span class="kn">import</span> <span class="n">stopwords</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NLTK stopwords ready.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading NLTK stopwords...&quot;</span><span class="p">)</span>
    <span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NLTK stopwords downloaded.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Setup complete - Optimized version!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All required packages already installed.
NLTK stopwords ready.
✅ Setup complete - Optimized version!
</pre></div>
</div>
</div>
</div>
<p><strong>Import Library dan Konfigurasi</strong></p>
<p>Import semua library yang diperlukan untuk analisis clustering dan konfigurasi environment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library sistem dan konfigurasi - VERSI OPTIMASI</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="w"> </span><span class="nn">re</span><span class="o">,</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>  <span class="c1"># Menyembunyikan warning untuk output yang bersih</span>

<span class="c1"># Import library untuk manipulasi data (ringan dan cepat)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>  <span class="c1"># Komputasi numerik</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>  <span class="c1"># Manipulasi data tabular</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>  <span class="c1"># Progress bar untuk iterasi</span>

<span class="c1"># Import library untuk visualisasi (hanya yang diperlukan)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>  <span class="c1"># Plotting dasar</span>
<span class="c1"># Hapus seaborn karena lambat untuk dataset besar</span>

<span class="c1"># Import NLTK untuk pemrosesan bahasa alami (sudah di-download di setup)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nltk.corpus</span><span class="w"> </span><span class="kn">import</span> <span class="n">stopwords</span>  <span class="c1"># Stopwords untuk preprocessing teks</span>

<span class="c1"># Import scikit-learn untuk machine learning (ringan dan cepat)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TfidfVectorizer</span>  <span class="c1"># Ekstraksi fitur TF-IDF</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">TruncatedSVD</span>  <span class="c1"># Dimensionality reduction dengan SVD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Normalizer</span>  <span class="c1"># Normalisasi data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_pipeline</span>  <span class="c1"># Pipeline untuk menggabungkan preprocessing steps</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">KMeans</span>  <span class="c1"># Algoritma clustering K-Means</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">silhouette_score</span><span class="p">,</span> <span class="n">normalized_mutual_info_score</span><span class="p">,</span> <span class="n">adjusted_rand_score</span>  <span class="c1"># Metrik evaluasi clustering</span>

<span class="c1"># Import alternatif untuk visualisasi (lebih cepat dari UMAP)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>  <span class="c1"># PCA sebagai alternatif UMAP yang lebih cepat</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✅ Library import complete - Optimized for speed!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Library import complete - Optimized for speed!
</pre></div>
</div>
</div>
</div>
<p><strong>Load Dataset</strong></p>
<p>Memuat dataset dari file CSV dengan penanganan berbagai encoding untuk memastikan kompatibilitas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load dataset dari file CSV</span>
<span class="n">csv_path</span> <span class="o">=</span> <span class="s2">&quot;spam.csv&quot;</span>  <span class="c1"># Path ke file dataset</span>

<span class="k">def</span><span class="w"> </span><span class="nf">try_read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fungsi untuk membaca CSV dengan berbagai encoding</span>
<span class="sd">    Mencoba beberapa encoding umum untuk menangani file dengan encoding berbeda</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Daftar encoding yang umum digunakan</span>
    <span class="n">encodings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="s2">&quot;latin1&quot;</span><span class="p">,</span> <span class="s2">&quot;cp1252&quot;</span><span class="p">,</span> <span class="s2">&quot;iso-8859-1&quot;</span><span class="p">]</span>
    
    <span class="c1"># Coba setiap encoding sampai berhasil</span>
    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="n">encodings</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">enc</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">last_err</span> <span class="o">=</span> <span class="n">e</span>  <span class="c1"># Simpan error terakhir jika semua gagal</span>
    <span class="k">raise</span> <span class="n">last_err</span>  <span class="c1"># Raise error jika semua encoding gagal</span>

<span class="c1"># Load dataset dengan fungsi yang sudah dibuat</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">try_read_csv</span><span class="p">(</span><span class="n">csv_path</span><span class="p">)</span>

<span class="c1"># Tampilkan informasi dasar dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape dataset: </span><span class="si">{</span><span class="n">raw</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Menampilkan jumlah baris dan kolom</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5 baris pertama dataset:&quot;</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape dataset: (5572, 5)
5 baris pertama dataset:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Text</th>
      <th>Unnamed: 2</th>
      <th>Unnamed: 3</th>
      <th>Unnamed: 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Go until jurong point, crazy.. Available only ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Ok lar... Joking wif u oni...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>U dun say so early hor... U c already then say...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Deteksi Kolom Teks dan Label</strong></p>
<p>Mengidentifikasi kolom yang berisi teks dan label secara otomatis berdasarkan nama kolom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Deteksi kolom teks dan label secara otomatis</span>
<span class="c1"># Konversi nama kolom ke lowercase untuk pencarian yang case-insensitive</span>
<span class="n">cols_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">col_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>  <span class="c1"># Mapping untuk mendapatkan nama kolom asli</span>

<span class="c1"># Cari kolom yang kemungkinan berisi teks berdasarkan kata kunci</span>
<span class="n">text_candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols_lower</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">c</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">,</span><span class="s2">&quot;message&quot;</span><span class="p">,</span><span class="s2">&quot;email&quot;</span><span class="p">,</span><span class="s2">&quot;content&quot;</span><span class="p">,</span><span class="s2">&quot;body&quot;</span><span class="p">,</span><span class="s2">&quot;teks&quot;</span><span class="p">,</span><span class="s2">&quot;berita&quot;</span><span class="p">,</span><span class="s2">&quot;pesan&quot;</span><span class="p">])]</span>
<span class="c1"># Cari kolom yang kemungkinan berisi label berdasarkan kata kunci</span>
<span class="n">label_candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols_lower</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">c</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">,</span><span class="s2">&quot;spam&quot;</span><span class="p">,</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="s2">&quot;kategori&quot;</span><span class="p">,</span><span class="s2">&quot;target&quot;</span><span class="p">])</span> <span class="p">]</span>

<span class="c1"># Pilih kolom pertama yang cocok, atau kolom pertama jika tidak ada yang cocok</span>
<span class="n">text_col</span> <span class="o">=</span> <span class="n">col_map</span><span class="p">[</span><span class="n">text_candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">text_candidates</span> <span class="k">else</span> <span class="n">raw</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">label_col</span> <span class="o">=</span> <span class="n">col_map</span><span class="p">[</span><span class="n">label_candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">label_candidates</span> <span class="k">else</span> <span class="kc">None</span>

<span class="c1"># Tampilkan kolom yang terdeteksi</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Text column: </span><span class="si">{</span><span class="n">text_col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Label column: </span><span class="si">{</span><span class="n">label_col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Buat dataframe baru dengan hanya kolom yang diperlukan</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[[</span><span class="n">text_col</span><span class="p">]</span> <span class="o">+</span> <span class="p">([</span><span class="n">label_col</span><span class="p">]</span> <span class="k">if</span> <span class="n">label_col</span> <span class="k">else</span> <span class="p">[])]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Rename kolom untuk konsistensi</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="n">text_col</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> 
    <span class="p">(</span><span class="n">label_col</span> <span class="k">if</span> <span class="n">label_col</span> <span class="k">else</span> <span class="n">text_col</span><span class="p">):</span> <span class="p">(</span><span class="s2">&quot;label&quot;</span> <span class="k">if</span> <span class="n">label_col</span> <span class="k">else</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1"># Hapus baris dengan teks kosong atau NaN</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span> 

<span class="c1"># Tampilkan informasi dataset setelah preprocessing</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape dataset setelah preprocessing: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5 baris pertama dataset:&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text column: Text
Label column: None
Shape dataset setelah preprocessing: (5572, 1)
5 baris pertama dataset:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Go until jurong point, crazy.. Available only ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ok lar... Joking wif u oni...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>U dun say so early hor... U c already then say...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Preprocessing dan Normalisasi Teks</strong></p>
<p>Membersihkan dan menormalisasi teks dengan menghapus stopwords, tokenisasi, dan filtering kata.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalisasi dan preprocessing teks</span>
<span class="c1"># Pastikan stopwords sudah terdownload</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
    <span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>

<span class="c1"># Load stopwords dalam bahasa Inggris dan Indonesia</span>
<span class="n">eng_stop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))</span>  <span class="c1"># Stopwords bahasa Inggris</span>
<span class="n">indo_stop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;indonesian&#39;</span><span class="p">))</span> <span class="k">if</span> <span class="s1">&#39;indonesian&#39;</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">fileids</span><span class="p">()</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># Stopwords bahasa Indonesia (jika tersedia)</span>

<span class="c1"># Gabungkan stopwords dengan kata-kata umum yang sering muncul di media sosial</span>
<span class="n">common_stops</span> <span class="o">=</span> <span class="n">eng_stop</span> <span class="o">|</span> <span class="n">indo_stop</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;rt&quot;</span><span class="p">,</span><span class="s2">&quot;amp&quot;</span><span class="p">,</span><span class="s2">&quot;via&quot;</span><span class="p">}</span>

<span class="c1"># Regex pattern untuk mengekstrak hanya kata yang terdiri dari huruf (A-Z, a-z)</span>
<span class="n">TOKEN_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[A-Za-z]+&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fungsi untuk menormalisasi teks:</span>
<span class="sd">    1. Konversi ke lowercase</span>
<span class="sd">    2. Tokenisasi menggunakan regex</span>
<span class="sd">    3. Hapus stopwords dan kata pendek (&lt; 3 karakter)</span>
<span class="sd">    4. Join kembali menjadi string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># Konversi ke huruf kecil</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">TOKEN_RE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>  <span class="c1"># Ekstrak token yang hanya berisi huruf</span>
    <span class="c1"># Filter token: hapus stopwords dan kata dengan panjang &lt; 3 karakter</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">common_stops</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>  <span class="c1"># Gabungkan kembali menjadi string</span>

<span class="c1"># Terapkan normalisasi ke semua teks</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">normalize</span><span class="p">)</span>

<span class="c1"># Hapus baris dengan teks kosong setelah preprocessing</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span>

<span class="c1"># Tampilkan hasil preprocessing</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape dataset setelah normalisasi: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Contoh teks asli dan hasil normalisasi:&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;clean&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape dataset setelah normalisasi: (5531, 2)
Contoh teks asli dan hasil normalisasi:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>clean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Go until jurong point, crazy.. Available only ...</td>
      <td>jurong point crazy available bugis great world...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ok lar... Joking wif u oni...</td>
      <td>lar joking wif oni</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
      <td>free entry wkly comp win cup final tkts may te...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>U dun say so early hor... U c already then say...</td>
      <td>dun say early hor already say</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
      <td>think goes usf lives around though</td>
    </tr>
    <tr>
      <th>5</th>
      <td>FreeMsg Hey there darling it's been 3 week's n...</td>
      <td>freemsg hey darling week word back like fun st...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Even my brother is not like to speak with me. ...</td>
      <td>even brother like speak treat like aids patent</td>
    </tr>
    <tr>
      <th>7</th>
      <td>As per your request 'Melle Melle (Oru Minnamin...</td>
      <td>request melle melle oru minnaminunginte nurung...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>WINNER!! As a valued network customer you have...</td>
      <td>winner valued network customer selected receiv...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Had your mobile 11 months or more? U R entitle...</td>
      <td>mobile months entitled update latest colour mo...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Ekstraksi Fitur dengan TF-IDF dan Dimensionality Reduction</strong></p>
<p>Menggunakan TF-IDF untuk mengubah teks menjadi vektor numerik dan SVD untuk mengurangi dimensi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ekstraksi fitur dengan TF-IDF dan dimensionality reduction dengan SVD (LSA)</span>
<span class="c1"># TF-IDF Vectorizer: mengubah teks menjadi vektor numerik</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span>
    <span class="n">max_features</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span>  <span class="c1"># Maksimal 30,000 fitur (kata) yang paling penting</span>
    <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>   <span class="c1"># Gunakan unigram (1 kata) dan bigram (2 kata)</span>
    <span class="n">min_df</span><span class="o">=</span><span class="mi">3</span>            <span class="c1"># Kata harus muncul minimal 3 kali di seluruh dokumen</span>
<span class="p">)</span>
<span class="n">X_tfidf</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;clean&#39;</span><span class="p">])</span>  <span class="c1"># Transform teks ke matriks TF-IDF</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape TF-IDF matrix: </span><span class="si">{</span><span class="n">X_tfidf</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Dimensionality reduction dengan SVD (Singular Value Decomposition)</span>
<span class="c1"># Juga dikenal sebagai Latent Semantic Analysis (LSA)</span>
<span class="n">svd</span> <span class="o">=</span> <span class="n">TruncatedSVD</span><span class="p">(</span>
    <span class="n">n_components</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># Kurangi ke 100 komponen utama</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>    <span class="c1"># Seed untuk reproduktibilitas</span>
<span class="p">)</span>
<span class="n">normalizer</span> <span class="o">=</span> <span class="n">Normalizer</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Normalisasi vektor ke unit length</span>

<span class="c1"># Gabungkan SVD dan normalizer dalam pipeline</span>
<span class="n">lsa</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">svd</span><span class="p">,</span> <span class="n">normalizer</span><span class="p">)</span>

<span class="c1"># Terapkan dimensionality reduction ke TF-IDF matrix</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">lsa</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_tfidf</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape setelah dimensionality reduction: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variance explained ratio: </span><span class="si">{</span><span class="n">svd</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape TF-IDF matrix: (5531, 4219)
Shape setelah dimensionality reduction: (5531, 100)
Variance explained ratio: 0.2504
</pre></div>
</div>
</div>
</div>
<p><strong>Grid Search untuk Mencari Jumlah Cluster Optimal</strong></p>
<p>Menggunakan silhouette score untuk menentukan jumlah cluster optimal dengan K-Means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grid search untuk mencari jumlah cluster optimal menggunakan silhouette score</span>
<span class="n">k_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>  <span class="c1"># Test dari 2 sampai 10 cluster</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List untuk menyimpan hasil evaluasi</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1"># Dictionary untuk menyimpan model dan label hasil clustering</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Melakukan grid search untuk mencari k optimal...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k</span><span class="se">\t</span><span class="s2">silhouette_score&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Loop untuk setiap nilai k</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_values</span><span class="p">:</span>
    <span class="c1"># Inisialisasi K-Means dengan k cluster</span>
    <span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    
    <span class="c1"># Fit model dan predict cluster labels</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">km</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="c1"># Hitung silhouette score untuk evaluasi kualitas clustering</span>
    <span class="n">sil</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    
    <span class="c1"># Simpan hasil</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span> <span class="s2">&quot;silhouette&quot;</span><span class="p">:</span> <span class="n">sil</span><span class="p">})</span>
    <span class="n">models</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">km</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>  <span class="c1"># Simpan model dan labels</span>
    
    <span class="c1"># Tampilkan hasil</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">sil</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Konversi hasil ke DataFrame untuk analisis</span>
<span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Cari k dengan silhouette score tertinggi</span>
<span class="n">best_row</span> <span class="o">=</span> <span class="n">res_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
<span class="n">best_k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">best_row</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Best k berdasarkan silhouette score: </span><span class="si">{</span><span class="n">best_k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette score terbaik: </span><span class="si">{</span><span class="n">best_row</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Ambil model dan labels terbaik</span>
<span class="n">best_model</span><span class="p">,</span> <span class="n">best_labels</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">best_k</span><span class="p">]</span>

<span class="c1"># Tampilkan tabel hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabel hasil evaluasi:&quot;</span><span class="p">)</span>
<span class="n">res_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Melakukan grid search untuk mencari k optimal...
k	silhouette_score
--------------------
2	0.0215
3	0.0231
4	0.0248
5	0.0293
6	0.0350
7	0.0389
8	0.0440
9	0.0479
10	0.0502

Best k berdasarkan silhouette score: 10
Silhouette score terbaik: 0.0502

Tabel hasil evaluasi:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>k</th>
      <th>silhouette</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0.021549</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>0.023110</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>0.024820</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>0.029266</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>0.034972</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>0.038888</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>0.044001</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>0.047879</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>0.050234</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Evaluasi dan Visualisasi Hasil Clustering</strong></p>
<p>Evaluasi clustering dengan metrik eksternal (jika ada ground truth) dan visualisasi menggunakan UMAP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluasi clustering dengan metrik eksternal (jika ada ground truth)</span>
<span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="c1"># Jika ada label asli (ground truth), hitung metrik eksternal</span>
    <span class="n">true_labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Normalized Mutual Information (NMI): mengukur kesamaan informasi antara clustering dan ground truth</span>
    <span class="n">nmi</span> <span class="o">=</span> <span class="n">normalized_mutual_info_score</span><span class="p">(</span><span class="n">true_labels</span><span class="p">,</span> <span class="n">best_labels</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Normalized Mutual Information (NMI): </span><span class="si">{</span><span class="n">nmi</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Adjusted Rand Index (ARI): mengukur kesamaan clustering dengan ground truth (0-1, 1 = perfect match)</span>
    <span class="n">ari</span> <span class="o">=</span> <span class="n">adjusted_rand_score</span><span class="p">(</span><span class="n">true_labels</span><span class="p">,</span> <span class="n">best_labels</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adjusted Rand Index (ARI): </span><span class="si">{</span><span class="n">ari</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Interpretasi:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- NMI &gt; 0.5: clustering yang baik&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- ARI &gt; 0.3: clustering yang cukup baik&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- ARI &gt; 0.5: clustering yang sangat baik&quot;</span><span class="p">)</span>
    
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ground truth labels tidak ditemukan; hanya melaporkan silhouette score.&quot;</span><span class="p">)</span>

<span class="c1"># Visualisasi clustering dalam 2D menggunakan PCA (lebih cepat dari UMAP)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Membuat visualisasi 2D dengan PCA (lebih cepat dari UMAP)...&quot;</span><span class="p">)</span>

<span class="c1"># Reduksi dimensi ke 2D untuk visualisasi menggunakan PCA</span>
<span class="n">reducer</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span>
    <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>    <span class="c1"># Reduksi ke 2 dimensi untuk plotting</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>    <span class="c1"># Seed untuk reproduktibilitas</span>
<span class="p">)</span>
<span class="n">X_2d</span> <span class="o">=</span> <span class="n">reducer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variance explained by PCA: </span><span class="si">{</span><span class="n">reducer</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot hasil clustering</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">scatter</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">X_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_2d</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> 
    <span class="n">c</span><span class="o">=</span><span class="n">best_labels</span><span class="p">,</span>           <span class="c1"># Warna berdasarkan cluster</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">,</span>           <span class="c1"># Colormap dengan 10 warna berbeda</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>                   <span class="c1"># Ukuran titik</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span>               <span class="c1"># Transparansi</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Visualisasi Clustering K-Means (k=</span><span class="si">{</span><span class="n">best_k</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">Silhouette Score: </span><span class="si">{</span><span class="n">best_row</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
          <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;PCA Component 1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PCA Component 2&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Tambahkan colorbar dengan label</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scatter</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Cluster ID&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Tambahkan grid untuk kemudahan membaca</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Tampilkan informasi cluster</span>
<span class="n">unique_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">best_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah cluster yang terbentuk: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_labels</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">:</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">best_labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">)</span>
    <span class="n">percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">best_labels</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> dokumen (</span><span class="si">{</span><span class="n">percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground truth labels tidak ditemukan; hanya melaporkan silhouette score.

Membuat visualisasi 2D dengan PCA (lebih cepat dari UMAP)...
Variance explained by PCA: 0.0447

Jumlah cluster yang terbentuk: 10
Cluster 0: 488 dokumen (8.8%)
Cluster 1: 184 dokumen (3.3%)
Cluster 2: 382 dokumen (6.9%)
Cluster 3: 214 dokumen (3.9%)
Cluster 4: 172 dokumen (3.1%)
Cluster 5: 445 dokumen (8.0%)
Cluster 6: 372 dokumen (6.7%)
Cluster 7: 2214 dokumen (40.0%)
Cluster 8: 145 dokumen (2.6%)
Cluster 9: 915 dokumen (16.5%)
</pre></div>
</div>
<img alt="_images/c0bf8c2a9eab5bda0d1dcca310afef8367384e79aca6a8781b9fd30ba03486a0.png" src="_images/c0bf8c2a9eab5bda0d1dcca310afef8367384e79aca6a8781b9fd30ba03486a0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tugas6-rifqi.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Klasifikasi Berita menggunakan Fitur Latent Dirichlet Allocation</p>
      </div>
    </a>
    <a class="right-next"
       href="page_rank.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analisis Graph Data dari pta_graph.xlsx</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Tugas UTS (Klasifikasi Berita dan Clustering Spam)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-berita-dengan-fitur-topik-lda-naive-bayes-svm">Klasifikasi Berita dengan Fitur Topik (LDA) + Naive Bayes &amp; SVM</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-spam-detection-dengan-k-means">Clustering Spam Detection dengan K-Means</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">Tujuan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologi">Metodologi</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>